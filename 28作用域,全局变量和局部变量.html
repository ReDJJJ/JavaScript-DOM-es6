<!-- 作用域

    作用域的概念: 变量起作用的区域范围;
    作用域分类: 全局作用域 和 局部(函数作用域)作用域 ;

    作用域作用: 隔离变量 (函数外部定义的和函数内部定义的同名变量 没有关系)

    全局变量:定义在全局环境中的变量就是全局变量(函数外部定义)
    局部变量:定义在局部环境(函数内部)的变量就是局部变量(函数内部)
    全局变量:在整个程序代码所有的地方都起作用;
    局部变量:只在自己的作用域(定义函数内部)起作用,外部不能使用内部定义的局部变量

    全局变量在函数内部可以进行操作,但是全局当中没法操作局部变量(除非变量在局部作用域内)
    若局部变量与全局变量重名:局部变量层叠掉全局变量; 
    
   

    以前的疑云: 以前以为函数内部只能调用函数内部定义的形式参数和函数内部定义的局部变量。不能调用和变更全局变量。
               其实是没有理解全局变量和局部变量的概念
               所以,参数传递只需要传一部分就可以了.像Π3.14这种固定实值可以交给全局变量
-->

<html>
    <head>
        <meta charset="utf-8" />
        <title></title>
        <style>

        </style>
    </head>

    <body>
        <script>
            var a = 10;
            var b = 20;
            var c = 30; //定义了a,b,c三个全局变量

            function fun(a,b){
                a = 100;
                c = 300;
                console.log("在函数内部的a和c:"+a+" "+c);
                return undefined;
            }
            fun(a,b);
            console.log("函数外部a:"+a);
            console.log("函数外部a:"+c);

            // 解析 函数fun外部定义了a,b,c三个全局变量;
            //      函数fun内部定义了两个局部变量 a,b  与三个全局变量中的a,b同名,同名变量发生的情况:局部变量在作用域内层叠掉全局变量a,b;
            //      所以fun()函数内部的 a=100 语句 是局部变量a的值变成了100; 全局变量a的值不变,还是10;
            //      全局变量ab和局部变量ab的唯一联系就是,实际参数和形式参数的值的复制传递,然后再无瓜葛。
            //      至于C,C只在函数外部定义了,是全局变量,全局变量在函数内部可以进行操作C=300,因此C的值变成了300


            // ！！！！！！！！！！！！！ 极其重要的关键点 ！！！！！！！！！！！！！！！/
            // 详细判断 一个变量 是 全局变量还是局部变量
            // 1在全局环境中定义的变量 一定是 全局变量 
            // 2当函数内部通过 var 定义的变量,一定是局部变量,并且层叠同名全局变量
            // 3当函数内部 有一个变量没有通过 var :
            //          3.1 此变量是否是形式参数,若是,此变量是局部变量
            //          3.2 此变量是否在全局环境中定义过的,若是此变量是全局变量,并且在函数内部操作着全局变量
            //          3.2 此变量既不是形参,又不是全局环境中出现过的变量,相当于函数内部和外部都没有定义过这个变量,此时就是在函数内部 新定义一个全局变量。


            // 坑:在函数内部定义一个全局变量
            var A = 1;
            var B = 2;
            var D = 100;
            function fun2(A){
                A=10;
                C=100;
                D = 10000;
                console.log(A);
                return undefined;
            }
           // console.log(C);//此时报凑无法打印,因为fun2函数为调用,C还未定义
            fun2();
            console.log(A);
            console.log(C);
            console.log(D);
            // 解析: 程序一开始定义了两个全局变量A,B,D;在函数中,定义了形式参数A,与全局变量A同名,因此形式参数A层叠掉了全局变量A,因此在fun2函数内部的A是局部变量
            // fun2()内部的打印语句打印的是局部变量形式参数A的值10.而程序结尾console.log(A)打印的是全局变量A的值1。
            // C,C的第一次出现在函数内部,并且C前面没有var关键字,所以C是在fun2函数内部新定义了一个全局变量C,并复制100.(前提是fun2要被调用,若不被调用,C不存在)
            // D,本身是全局变量,并且函数内部没有同名变量层叠掉他,因此D是fun2中调用操作全局变量D,将全局变量的D值改为10000;

            // 总结:遇见函数内部 X = 100; 没有var的: 1看函数内部是否已经var过定义或者是形式参数 若有则局部变量
            //                                      若1无,看外部有没有定义过X的全局变量,若有全局变量
            //                                      若1,2都无,则在函数内部定义了一个新的全局变量


            // fun(a,b)和fun2(A)各自的局部变量也是不通用的,因为没有嵌套关系;
            //  当多个函数嵌套时: 内部被嵌套函数可用外部包含定义的局部变量, 外部的不可以使用内部定义的局部变量 
            var num1 =100,num2 = 100 ,num3 = 100;

            
            function funfather(num1){
                num1 = 0; //没有var 但是是形式参数num,所以是局部变量 层叠了全局变量num1;
                num3 = 20; //没有var ,不是形参,但是是全局定义的全局变量,因此是内部函数调用全局变量
                function funson(){ //整个funson嵌套在funfather()内部声明,所以是funfather()局部变量的作用域
                    var numofson = 100;
                    num1 = 100;//允许,局部变量num1的作用域是整个 funfather
                    test = 123456; //没有var过,不是形式参数 ,也不是funfather内的局部变量,也不是全局变量,所以在此创造了一个新的全局变量test
                } 
                funson(); // funfather()嵌套了funson的运行
            }
           
            funfather(num1);
            funson(); //会报错 定义函数本质上是定义一个变量,所以在funfather()内部定义了一个局部变量funson,该funson是局部变量,只能在funfather内部调用.在全局环境下调用会报错
                      // 加深理解：平时在全局变量中的函数声明的是全局变量,哪都可以用.在函数声明的内部的嵌套函数声明,子声明是局部变量,所以只能在局部作用域内使用(调用)子函数,也可以通过赋予子嵌套函数的地址给全局遍历,闭包就是这样做的
            console.log(test);
          
        </script>
    </body>
</html>